react-window

è§ï¼š react-window.md

[è™šæ‹Ÿåˆ—è¡¨-æ€ç»´å¯¼å›¾-ProcessOn](https://www.processon.com/mindmap/641c5b22314bb554fea08aa4)



https://react-window.vercel.app/#/examples/list/fixed-size

å‚è€ƒï¼š
https://www.codeleading.com/article/83464600958/

## æ•™ç¨‹

[ã€å‰ç«¯æŠ€èƒ½æå‡ã€‘ç”¨react-windowå®ç°çœå†…å­˜çš„å‘ˆç°å¤§é‡æ•°æ®åˆ—è¡¨_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1G14y1L76U/?spm_id_from=333.788.recommend_more_video.2&vd_source=abb66f1f7d240b0556df3816424c3d88)



[useVirtualList - ahooks 3.0](https://ahooks.js.org/zh-CN/hooks/use-virtual-list/)

#### ä¸å®šé«˜æ—¶

![image-20230322084522143](è™šæ‹Ÿåˆ—è¡¨.assets/image-20230322084522143.png)



åˆ‡æ–°åˆ†æ”¯ 

åˆ‡master

git tag 1.0.0

git merge æ–°åˆ†æ”¯ --no-ff



9åˆ†28 TODO

[ã€å‰ç«¯æŠ€èƒ½æå‡ã€‘react-window åº”ç”¨windowçš„æ»šåŠ¨æ¡ è™šæ‹Ÿåˆ—è¡¨çš„åº”ç”¨_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1XG411A7NA/?spm_id_from=333.999.0.0&vd_source=abb66f1f7d240b0556df3816424c3d88)







## react-window-infinite-loader

åˆ†æ¬¡è¯·æ±‚è¦åŠ è½½çš„æ•°æ®

[bvaughn/react-window-infinite-loader: InfiniteLoader component inspired by react-virtualized but for use with react-window (github.com)](https://github.com/bvaughn/react-window-infinite-loader)



[åœ¨çº¿é¢„è§ˆ - CodeSandbox](https://codesandbox.io/s/x70ly749rq?file=/src/App.js)

```jsx
const itemCount = 1000;

<InfiniteLoader
  isItemLoaded={isItemLoaded}
  itemCount={itemCount}
  loadMoreItems={loadMoreItems}
>
  {({ onItemsRendered, ref }) => (
    <FixedSizeList
      itemCount={itemCount}
      onItemsRendered={onItemsRendered}
      ref={ref}
      {...otherListProps}
    />
  )}
</InfiniteLoader>
```

### api

| Name               | Type                                                         | Description                                                  |      |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ---- |
| `children`         | `({ onItemsRendered: Function, ref: React$Ref }) => React$Node` | Render prop. See below for example usage.                    |      |
| `isItemLoaded`     | `(index: number) => boolean`                                 | è´Ÿè´£è®°å½•æ¯ä¸€é¡¹æ˜¯å¦åŠ è½½å®Œæˆçš„æ–¹æ³•                             |      |
| `itemCount`        | `number`                                                     | åˆ—è¡¨ä¸­çš„é¡¹ç›®æ•°ï¼ˆæˆ–é¢„æœŸï¼‰                                     |      |
| `loadMoreItems`    | `(startIndex: number, stopIndex: number) => Promise<void>`   | ç¿»é¡µæ—¶è¿”å›promiseçš„å›è°ƒï¼Œç”¨äºè¯·æ±‚ä¸‹ä¸€é¡µ                      |      |
| `minimumBatchSize` | `?number`                                                    | Minimum number of rows to be loaded at a time; defaults to 10. This property can be used to batch requests to reduce HTTP requests. | TODO |
| `threshold`        | `?number`                                                    | Threshold at which to pre-fetch data; defaults to 15. A threshold of 15 means that data will start loading when a user scrolls within 15 rows. | TODO |

### code

```jsx
function ExampleWrapper({
 // æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€é¡µï¼Œæ ¹æ®æœ€è¿‘ä¸€æ¬¡çš„APIè¯·æ±‚è·å¾—
  hasNextPage,
	// boolean, ç”¨äºæŒ‡ç¤ºæ˜¯å¦æ­£åœ¨åŠ è½½ä¸‹ä¸€é¡µæ•°æ®
  isNextPageLoading,
  // å·²ç»åŠ è½½è¿‡çš„itemsæ•°ç»„
  items,
  // å›è°ƒå‡½æ•°ï¼Œè´Ÿè´£åŠ è½½ä¸‹ä¸€é¡µ
  loadNextPage
}) {
  // å¦‚æœå­˜åœ¨ä¸‹ä¸€é¡µåˆ™å¢åŠ ä¸€è¡Œ æ˜¾ç¤ºloading
  const itemCount = hasNextPage ? items.length + 1 : items.length;
	// åŠ è½½ä¸‹ä¸€é¡µçš„æ–¹æ³•ï¼Œloadingæ—¶ä¸ºç©ºå‡½æ•°
  const loadMoreItems = isNextPageLoading ? () => {} : loadNextPage;
  // æ¯ä¸€é¡¹æ˜¯å¦åŠ è½½å®Œï¼ˆä¸åŒ…å«loading)ï¼Œ1ã€æ²¡æœ‰ä¸‹ä¸€é¡µæ—¶ï¼Œ 2ã€å½“å‰ç´¢å¼•å°äºitemsé•¿åº¦
  const isItemLoaded = index => !hasNextPage || index < items.length;

  // æ¸²æŸ“æ¯ä¸€é¡¹æˆ–loading
  const Item = ({ index, style }) => {
    let content;
    if (!isItemLoaded(index)) {
      content = "Loading...";
    } else {
      content = items[index].name;
    }

    return <div style={style}>{content}</div>;
  };

  return (
    <InfiniteLoader
      isItemLoaded={isItemLoaded}
      itemCount={itemCount}
      loadMoreItems={loadMoreItems}
    >
      {({ onItemsRendered, ref }) => (
        <FixedSizeList
          itemCount={itemCount}
          onItemsRendered={onItemsRendered}
          ref={ref}
          {...props}
        >
          {Item}
        </FixedSizeList>
      )}
    </InfiniteLoader>
  );
}
```

### Advanced usage

Some use cases require cached items to be reset. For example, after a list has been sorted, previously cached items may be invalid. You can let `InfiniteLoader` know that it needs to reload cached items by calling the `resetloadMoreItemsCache` method.

```jsx
function ExampleWrapper({
  // ...
  sortOrder,
}) {
  // We create a reference for the InfiniteLoader
  const infiniteLoaderRef = useRef(null);
  const hasMountedRef = useRef(false);

  // Each time the sort prop changed we called the method resetloadMoreItemsCache to clear the cache
  useEffect(() => {
    // We only need to reset cached items when "sortOrder" changes.
    // This effect will run on mount too; there's no need to reset in that case.
    if (hasMountedRef.current) {
      if (infiniteLoaderRef.current) {
        infiniteLoaderRef.current.resetloadMoreItemsCache();
      }
    }
    hasMountedRef.current = true;
  }, [sortOrder]);
  
  // ...

  // We passed down the ref to the InfiniteLoader component
  return (
    <InfiniteLoader
      ref={infiniteLoaderRef}
      isItemLoaded={isItemLoaded}
      itemCount={itemCount}
      loadMoreItems={loadMoreItems}
    >
      {({ onItemsRendered, ref }) => (
        // ...
      )}
    </InfiniteLoader>
  );
}
```

### å‚è€ƒ

[ä½¿ç”¨ react-window è™šæ‹ŸåŒ–å¤§å‹åˆ—è¡¨ (web.dev)](https://web.dev/virtualize-long-lists-react-window/#æ»šåŠ¨æ—¶å»¶è¿ŸåŠ è½½)

## react-virtualized-auto-sizer

é«˜é˜¶ç»„ä»¶ï¼ˆä¼šè‡ªåŠ¨è°ƒæ•´åˆ—è¡¨çš„å®½é«˜ï¼Œä½¿å…¶è‡ªé€‚åº”å½“å‰é¡µé¢çš„å®½é«˜ï¼‰

[APIæ–‡æ¡£  ](https://github.com/bvaughn/react-virtualized/blob/master/docs/AutoSizer.md)

ç•¥ï¼Œæ²¡å•¥ä¸œè¥¿https://github.com/bvaughn/react-virtualized-auto-sizer 

```jsx
import React from 'react';
import ReactDOM from 'react-dom';
import {AutoSizer, List} from 'react-virtualized';
import 'react-virtualized/styles.css'; // only needs to be imported once

// List data as an array of strings
const list = [
  'Brian Vaughn',
  // And so on...
];

function rowRenderer({key, index, style}) {
  return (
    <div key={key} style={style}>
      {list[index]}
    </div>
  );
}

// Render your list
ReactDOM.render(
  <AutoSizer>
    {({height, width}) => (
      <List
        height={height}
        rowCount={list.length}
        rowHeight={20}
        rowRenderer={rowRenderer}
        width={width}
      />
    )}
  </AutoSizer>,
  document.getElementById('example'),
);
```

## å…¶å®ƒè™šæ‹Ÿåº“

- [react-virtualized-checkbox](https://github.com/emilebres/react-virtualized-checkbox): Checkbox group component with virtualization for large number of options
- [react-virtualized-select](https://github.com/bvaughn/react-virtualized-select): Drop-down menu for React with windowing to support large numbers of options.
- [react-virtualized-tree](https://github.com/diogofcunha/react-virtualized-tree/): A reactive tree component that aims to render large sets of tree structured data in an elegant and performant way
- [react-infinite-calendar](https://github.com/clauderic/react-infinite-calendar): Infinite scrolling date-picker with localization, themes, keyboard support, and more

## å®é™…åœºæ™¯åº”ç”¨

æˆ‘ä»¬åˆ—è¡¨éœ€æ±‚ æ¯æ¡æ•°æ®å¯ä»¥é…ç½®å›¾ç‰‡ä¹Ÿå¯ä»¥ä¸é…ç½®å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥é…ç½®è§†é¢‘ï¼Œè§†é¢‘çš„é«˜åº¦ä¹Ÿæ˜¯è·Ÿç€è§†é¢‘æ¯”ä¾‹ç®—çš„ï¼Œåˆ—è¡¨é‡Œé¢è¿˜ä¼šæ’å…¥ åˆ«çš„æ•°æ®ï¼Œè¿™ç§æƒ…å†µæ¯ä¸€é¡¹é«˜åº¦æåº¦ä¸åŒä¸€ï¼Œè¦æ€ä¹ˆå¤„ç†



vue-virtual-scrollerï¼š ä¸‹é¢æ–‡ç« é˜è¿°äº†é€‰æ‹©è¯¥åº“åŸå› 

[è™šæ‹Ÿåˆ—è¡¨æŠ€æœ¯å¼•å…¥ - ç»¼è¿° - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7067133947041447943)



## åŸç†



## æºç 

TODO

https://codesandbox.io/s/react-windowmo-ni-shi-xian-vxs84o?file=/src/index.js



æˆ‘ä»¬ä½¿ç”¨å®˜æ–¹åº“æ•ˆæœå¦‚ä¸‹ï¼š

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a7bd86685c624f279cd5608c278667c5~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp)

> æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯è§†åŒºå†…å±•ç¤º `4` é¡¹ï¼Œä½†æ˜¯ `dom` ç»“æ„ä¸­å±•ç¤ºäº† `6` é¡¹ï¼Œè¿™æ˜¯å› ä¸ºåˆ—è¡¨åœ¨ä¸Šä¸‹æ»‘åŠ¨çš„æ—¶å€™åšäº†ä¸€ä¸ªç¼“å†²ï¼Œé¿å…æ»šåŠ¨çš„æ—¶å€™æœ‰ä¸ªç™½å±çš„æ•ˆæœï¼Œç±»ä¼¼ç¼“å­˜ã€‚

> é‚£è¿™é‡Œå…ƒç´ çš„å®šä½ä¸ºä»€ä¹ˆä½¿ç”¨å®šä½å½¢å¼åˆä½¿ç”¨ `will-change` å‘¢ï¼Ÿè¿™æ˜¯ä½¿ç”¨äº† `will-change`ï¼Œè®©æµè§ˆå™¨å°±å¯ä»¥æå‰çŸ¥é“å“ªäº›å…ƒç´ çš„å±æ€§å°†ä¼šæ”¹å˜ï¼ŒæŠŠå…ƒç´ æå‡åˆ°ä¸€ä¸ªæ–°å±‚ï¼Œæå‡æ€§èƒ½ï¼ŒåŒæ—¶é¿å…äº†é‡æ’é‡ç»˜ã€‚

[will-change - CSSï¼šå±‚å æ ·å¼è¡¨ | MDN (mozilla.org)](https://developer.mozilla.org/zh-CN/docs/Web/CSS/will-change)

[CSS will-change å±æ€§ - yuzhongwusan - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/yuzhongwusan/p/4186405.html)



ä½œè€…ï¼šæµ‹ä¸å‡†
é“¾æ¥ï¼šhttps://juejin.cn/post/7146978530889302047
æ¥æºï¼šç¨€åœŸæ˜é‡‘
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚



## å®ç°è™šæ‹Ÿåˆ—è¡¨ï¼Ÿ



### ç½‘å‹

è¿™ç§æ–¹å¼å®ç°çš„é—®é¢˜æ¯”è¾ƒå¤šï¼Œä¸»è¦å°±æ˜¯åœ¨æ»šåŠ¨æ—¶çš„å¡é¡¿ã€‚åœ¨å•å…ƒæ ¼å†…å®¹ä½¿ç”¨å‡½æ•°æˆ–è€…æ›´å¤æ‚çš„æ¸²æŸ“æ–¹å¼çš„æ—¶å€™ï¼Œæ»šåŠ¨æµç•…åº¦è¿˜ä¸å¦‚éè™šæ‹ŸåŒ–ã€‚æœ¬è´¨åŸå› æ˜¯æµè§ˆå™¨çš„æ»šåŠ¨æ¡åœ¨æ»šåŠ¨çš„æ—¶å€™å’Œjsæ‰§è¡Œæ˜¯äº’æ–¥çš„ï¼Œå¿…é¡»è¦æ¨¡æ‹Ÿä¸€ä¸ªæ»šåŠ¨æ¡ï¼Œç„¶åå†ç”¨jså»è°ƒç”¨æ»šåŠ¨ï¼Œè¿™æ ·å°±èƒ½ä¿è¯åœ¨å®é™…æ¸²æŸ“å‰jså·²ç»æ‰§è¡Œå¥½äº†ï¼Œå®é™…ä¸Šåªæœ‰æ¸²æŸ“çš„äº‹æƒ…äº†ã€‚

å¤§æ¦‚æ˜¯ç”¨transformå…ˆå°†å®¹å™¨çš„æ»šåŠ¨æ¡æŒ¤å‡ºå¯è§†åŒºåŸŸï¼Œç„¶åç”¨è‡ªå·±å®ç°çš„æ»šåŠ¨æ¡å»æ¸²æŸ“åˆ°åŸå…ˆçš„ä½ç½®ï¼ŒåŒæ—¶ç›‘å¬é¼ æ ‡æ»šè½®äº‹ä»¶(mousewheel)ï¼Œæ ¹æ®æ»šè½®çš„çŠ¶æ€ï¼ˆ1ï¼Œ-1ï¼‰æ¥è®¡ç®—æ»šåŠ¨çš„ä½ç½®ï¼Œç„¶åç›´æ¥è°ƒç”¨jsçš„scrollToå»æ»šåŠ¨åˆ°å¯¹åº”çš„ä½ç½®ã€‚




è¿™ç§æ–¹å¼é…åˆå®ç°æ–¹å¼ä¸ºå®šä½çš„è™šæ‹Ÿåˆ—è¡¨æ•ˆæœæ¯”è¾ƒå¥½ï¼Œå¯ä»¥å°†å…·ä½“å±•ç¤ºçš„è¡¨æ ¼å†…å®¹å®šä½åˆ°å®¹å™¨åŒºåŸŸï¼Œæ ¹æ®scrollçš„ä½ç½®è®¡ç®—åº”è¯¥æ˜¾ç¤ºçš„æ•°æ®ï¼Œç„¶åé‡æ–°è®¡ç®—å®šä½ä½ç½®å³å¯ï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦çš„å»å¤ç”¨å…ƒç´ ã€‚



å…·ä½“çš„å¯ä»¥å‚è€ƒè¿™é‡Œ[![img](https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/3f843e8626a3844c624fb596dddd9674.svg)segmentfault.com](https://link.juejin.cn/?target=https%3A%2F%2Fsegmentfault.com%2Fa%2F1190000039808261)ï¼Œç„¶åè‡ªå·±å»å®ç°ä¸€ä¸‹ï¼Œå¹¶ä¸æ˜¯å¾ˆéš¾ã€‚è¡¨æ ¼è¿˜æœ‰å¾ˆå¤šå…¶ä»–åŠŸèƒ½ï¼Œå¦‚ä½•æŠŠå®ƒä»¬æ•´åˆåˆ°ä¸€èµ·ï¼Œæ€ä¹ˆå»è®¾è®¡å¥½æ‰æ˜¯éš¾ç‚¹ã€‚



## å‚è€ƒ

[éƒ½2022å¹´äº†ï¼Œè™šæ‹Ÿåˆ—è¡¨è¿˜ä¸æ‡‚ï¼Œå¿«çœ‹è¿‡æ¥ğŸ‘ˆ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7078847732168785950#heading-7)

[Taroè™šæ‹Ÿåˆ—è¡¨è¸©å‘ - æ–‡å­¦å°‘å¥³ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/Ewarm/p/13667240.html)

[åˆ¶ä½œä¸€ä¸ªå¸¦æœ‰æ»‘å—çš„è™šæ‹Ÿåˆ—è¡¨ | çƒŸé›¨è¿·ç¦»åŠä¸–æ®‡çš„æˆé•¿ä¹‹è·¯ (lfzxb.top)](https://www.lfzxb.top/make-a-virtual-list-with-a-slider/)

[å‰ç«¯ç»„ä»¶åŒ–åŸ‹ç‚¹çš„å®è·µ | äº‘éŸ³ä¹å¤§å‰ç«¯ä¸“æ  (musicfe.com)](https://musicfe.com/web-track/)

[åä¸‡æ¡æ•°æ®ï¼Œåç«¯ä¸åˆ†é¡µå’‹åŠï¼ï¼ˆå¦‚ä½•ä¼˜åŒ–é•¿åˆ—è¡¨æ¸²æŸ“ï¼‰ - éšé£çš„åšå®¢ (jkboy.com)](https://jkboy.com/archives/13620.html)

[ç®€å•æ˜“ç”¨çš„é«˜æ€§èƒ½ä¸å®šé«˜é¡¹è™šæ‹Ÿåˆ—è¡¨ - DCloud æ’ä»¶å¸‚åœº](https://ext.dcloud.net.cn/plugin?id=7129)

[Reactå®ç°è™šæ‹Ÿæ»šåŠ¨ | Eternallycyf (wangxince.site)](http://wangxince.site/eternallycyf/Reactå®ç°è™šæ‹Ÿæ»šåŠ¨/)

[å…¨é¢è§£æreact-windowæºç  - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7087083033156648967#heading-2)

[mini react-window(ä¸€) å®ç°å›ºå®šé«˜åº¦è™šæ‹Ÿæ»šåŠ¨ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7146978530889302047#comment)
